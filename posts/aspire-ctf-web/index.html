<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>AspireCTF Web Challenge - tukmogi blog</title><meta name=Description content><meta property="og:title" content="AspireCTF Web Challenge"><meta property="og:description" content="IntroductionThis is a writeup on the Web Challenge of the Aspire CTF - 2021.
AgentXChallenge Description  Where are you from?   Challenge site The paste contained the ips below
62.210.105.116 51.77.135.89 171.25.193.78 171.25.193.20 185.220.101.208 171.25.193.77 185.165.168.229 185.220.102.8 162.247.72.199 107.189.10.27 106.12.102.21 Following the access link, there is a PHP page that displays the IP address and errors out, Invalid Access! We can try to find out how developers access the IP address of a client."><meta property="og:type" content="article"><meta property="og:url" content="https://mogoria.github.io/posts/aspire-ctf-web/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-06T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AspireCTF Web Challenge"><meta name=twitter:description content="IntroductionThis is a writeup on the Web Challenge of the Aspire CTF - 2021.
AgentXChallenge Description  Where are you from?   Challenge site The paste contained the ips below
62.210.105.116 51.77.135.89 171.25.193.78 171.25.193.20 185.220.101.208 171.25.193.77 185.165.168.229 185.220.102.8 162.247.72.199 107.189.10.27 106.12.102.21 Following the access link, there is a PHP page that displays the IP address and errors out, Invalid Access! We can try to find out how developers access the IP address of a client."><meta name=application-name content="tukmogi blog"><meta name=apple-mobile-web-app-title content="tukmogi blog"><meta name=theme-color content="#f8f8f8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=https://mogoria.github.io/posts/aspire-ctf-web/><link rel=next href=https://mogoria.github.io/posts/forge-htb/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"AspireCTF Web Challenge","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mogoria.github.io\/posts\/aspire-ctf-web\/"},"genre":"posts","keywords":"Aspire, CTF","wordcount":948,"url":"https:\/\/mogoria.github.io\/posts\/aspire-ctf-web\/","datePublished":"2021-04-06T00:00:00+00:00","dateModified":"2021-04-06T00:00:00+00:00","publisher":{"@type":"Organization","name":"tukmogi"},"author":{"@type":"Person","name":"tukmogi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e)}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(t){const e=document.getElementsByTagName("meta");for(let n=0;n<e.length;n++)if(e[n].getAttribute("name")===t)return e[n];return''}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light")}else''==="light"||''==="dark"||''==="black"?(setTheme(''),saveTheme('')):(saveTheme("auto"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="tukmogi blog"><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=# onclick=return!1 class="menu-item theme-select" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-desktop title="Switch Theme"><option value=light>Light</option><option value=dark>Dark</option><option value=black>Black</option><option value=auto>Auto</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="tukmogi blog"><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=# onclick=return!1 class="menu-item theme-select" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-mobile title="Switch Theme"><option value=light>Light</option><option value=dark>Dark</option><option value=black>Black</option><option value=auto>Auto</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#agentx>AgentX</a></li><li><a href=#cookie-jar>Cookie Jar</a></li><li><a href=#filer>Filer</a></li><li><a href=#method-man>Method man</a></li><li><a href=#words>Words</a><ul><li><a href=#words1>Words1</a></li></ul></li><li><a href=#executor>Executor</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">AspireCTF Web Challenge</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=/ title=Author rel=author class=author>tukmogi</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>categories <a href=/categories/aspire/><i class="far fa-folder fa-fw"></i>aspire</a>&nbsp;<a href=/categories/web/><i class="far fa-folder fa-fw"></i>web</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-04-06>2021-04-06</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2021-04-06>2021-04-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;948 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload data-src=/images/aspire-ctf-web/aspire-web-thumb.png data-srcset="/images/aspire-ctf-web/aspire-web-thumb.png, /images/aspire-ctf-web/aspire-web-thumb.png 1.5x, /images/aspire-ctf-web/aspire-web-thumb.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/aspire-web-thumb.png title=/images/aspire-ctf-web/aspire-web-thumb.png height=auto width=auto></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#agentx>AgentX</a></li><li><a href=#cookie-jar>Cookie Jar</a></li><li><a href=#filer>Filer</a></li><li><a href=#method-man>Method man</a></li><li><a href=#words>Words</a><ul><li><a href=#words1>Words1</a></li></ul></li><li><a href=#executor>Executor</a></li></ul></nav></div></div><div class=content id=content><h2 id=introduction class=headerLink><a href=#introduction class=header-mark></a>Introduction</h2><p>This is a writeup on the Web Challenge of the Aspire CTF - 2021.</p><h2 id=agentx class=headerLink><a href=#agentx class=header-mark></a>AgentX</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Where are you from?</div></div></div><p>Challenge site
<img class=lazyload data-src=/images/aspire-ctf-web/4-2.png data-srcset="/images/aspire-ctf-web/4-2.png, /images/aspire-ctf-web/4-2.png 1.5x, /images/aspire-ctf-web/4-2.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/4-2.png title="Challenge Site"></p><p>The paste contained the ips below</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>62.210.105.116
</span></span><span class=line><span class=cl>51.77.135.89
</span></span><span class=line><span class=cl>171.25.193.78
</span></span><span class=line><span class=cl>171.25.193.20
</span></span><span class=line><span class=cl>185.220.101.208
</span></span><span class=line><span class=cl>171.25.193.77
</span></span><span class=line><span class=cl>185.165.168.229
</span></span><span class=line><span class=cl>185.220.102.8
</span></span><span class=line><span class=cl>162.247.72.199
</span></span><span class=line><span class=cl>107.189.10.27
</span></span><span class=line><span class=cl>106.12.102.21
</span></span></code></pre></div><p>Following the access link, there is a PHP page that displays the IP address and errors out, Invalid Access! We can try to find out how developers access the IP address of a client. An interesting find is that there are headers used by proxies to identify the client sending the request. That is the X-FORWARDED-FOR header and the CLIENT-IP header. Trying out a request with the X-FORWARDED-HOST header set, we see that we can now manipulate the client IP.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -s -H <span class=s1>&#39;x-forwarded-for: localhost&#39;</span> http://45.32.238.36/agentX/access.php <span class=p>;</span> <span class=nb>echo</span>
</span></span></code></pre></div><p><img class=lazyload data-src=/images/aspire-ctf-web/4-3.png data-srcset="/images/aspire-ctf-web/4-3.png, /images/aspire-ctf-web/4-3.png 1.5x, /images/aspire-ctf-web/4-3.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/4-3.png title="Agentx curl"></p><p>Using the IPs obtained from the paste, we can try and brute-force for valid ones. Wfuzz was used for this but Burp Suite’s intruder could also work.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wfuzz -c -w clients.txt -H <span class=s1>&#39;x-forwarded-for: FUZZ&#39;</span> http://45.32.238.36/agentX/access.php
</span></span></code></pre></div><p><img class=lazyload data-src=/images/aspire-ctf-web/4-4.png data-srcset="/images/aspire-ctf-web/4-4.png, /images/aspire-ctf-web/4-4.png 1.5x, /images/aspire-ctf-web/4-4.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/4-4.png title="Agentx flag"></p><p>Another note is that, since the site reflects data sent from the X-FORWARDED-FOR and CLIENT-IP headers, it&rsquo;s vulnerable to Cross-Site Scripting (XSS). We can confirm this by trying out the payload: <code>X-FORWARDED-FOR: &lt;script>alert(document.domain)&lt;/script></code></p><h2 id=cookie-jar class=headerLink><a href=#cookie-jar class=header-mark></a>Cookie Jar</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>The admin has your flag</div></div></div><p>Accessing the challenge site hints at a role-based website, admin privilege is needed to access the page.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/5-2.png data-srcset="/images/aspire-ctf-web/5-2.png, /images/aspire-ctf-web/5-2.png 1.5x, /images/aspire-ctf-web/5-2.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/5-2.png title=/images/aspire-ctf-web/5-2.png></p><p>Cookies are used to store content on the browser and are forwarded to the server on each request. Some authentication systems use cookies to automatically handle authentication. Checking out cookies on the website, we see that there is a cookie value called role.
<img class=lazyload data-src=/images/aspire-ctf-web/5-3.png data-srcset="/images/aspire-ctf-web/5-3.png, /images/aspire-ctf-web/5-3.png 1.5x, /images/aspire-ctf-web/5-3.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/5-3.png title=/images/aspire-ctf-web/5-3.png>
Changing this value to admin and refreshing, the page, we get the flag.
<img class=lazyload data-src=/images/aspire-ctf-web/5-4.png data-srcset="/images/aspire-ctf-web/5-4.png, /images/aspire-ctf-web/5-4.png 1.5x, /images/aspire-ctf-web/5-4.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/5-4.png title=/images/aspire-ctf-web/5-4.png></p><h2 id=filer class=headerLink><a href=#filer class=header-mark></a>Filer</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Find the vulnerability, look around and you&rsquo;ll find the flag! Can you access our passwords?</div></div></div><p>Assessing the challenge site, we get this page.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/6-2.png data-srcset="/images/aspire-ctf-web/6-2.png, /images/aspire-ctf-web/6-2.png 1.5x, /images/aspire-ctf-web/6-2.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/6-2.png title=/images/aspire-ctf-web/6-2.png></p><p>We can try and find out the valid parameters on the website. Using the extension Param Miner on Burp Suite, we can try and find parameters on the website. Right-click on a request then click on ‘Guess GET parameters’, on the extensions tab, we get output from param miner. There is a valid parameter found called ‘file’.
<img class=lazyload data-src=/images/aspire-ctf-web/6-3.png data-srcset="/images/aspire-ctf-web/6-3.png, /images/aspire-ctf-web/6-3.png 1.5x, /images/aspire-ctf-web/6-3.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/6-3.png title=/images/aspire-ctf-web/6-3.png>
Arjun can also be used.
Passing a file name to the parameter displays it and that’s how we get the flag.
<img class=lazyload data-src=/images/aspire-ctf-web/6-4.png data-srcset="/images/aspire-ctf-web/6-4.png, /images/aspire-ctf-web/6-4.png 1.5x, /images/aspire-ctf-web/6-4.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/6-4.png title=/images/aspire-ctf-web/6-4.png></p><h2 id=method-man class=headerLink><a href=#method-man class=header-mark></a>Method man</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>The admin is particularly fond of numbers below 200. Find what he has hidden</div></div></div><p>Accessing the challenge site, we find this.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/7-2.png data-srcset="/images/aspire-ctf-web/7-2.png, /images/aspire-ctf-web/7-2.png 1.5x, /images/aspire-ctf-web/7-2.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/7-2.png title=/images/aspire-ctf-web/7-2.png></p><p>Once more, using param miner or Arjun, we discover a parameter called code.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/7-3.png data-srcset="/images/aspire-ctf-web/7-3.png, /images/aspire-ctf-web/7-3.png 1.5x, /images/aspire-ctf-web/7-3.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/7-3.png title=/images/aspire-ctf-web/7-3.png></p><p>Passing code 1, the page doesn’t display any content. Based on the hint from the home page, we can tell that the code could be anything between 1 and 200</p><p><img class=lazyload data-src=/images/aspire-ctf-web/7-4.png data-srcset="/images/aspire-ctf-web/7-4.png, /images/aspire-ctf-web/7-4.png 1.5x, /images/aspire-ctf-web/7-4.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/7-4.png title=/images/aspire-ctf-web/7-4.png></p><p>We can use Burp Suite intruder to brute force for the right code. Send the request to Intruder, on the payloads tab, specify numbers as the payload type as numbers. Set the payload options to run from 1 to 200 and step once.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/7-5.png data-srcset="/images/aspire-ctf-web/7-5.png, /images/aspire-ctf-web/7-5.png 1.5x, /images/aspire-ctf-web/7-5.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/7-5.png title=/images/aspire-ctf-web/7-5.png></p><p>Filter the results by length. From that, we find that two requests are unique. Viewing the response of code 79, we find our flag.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/7-6.png data-srcset="/images/aspire-ctf-web/7-6.png, /images/aspire-ctf-web/7-6.png 1.5x, /images/aspire-ctf-web/7-6.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/7-6.png title=/images/aspire-ctf-web/7-6.png></p><p>Wfuzz can also be used to brute-force for the code since Burp intruder tends to be slow when using the community edition.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/7-7.png data-srcset="/images/aspire-ctf-web/7-7.png, /images/aspire-ctf-web/7-7.png 1.5x, /images/aspire-ctf-web/7-7.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/7-7.png title=/images/aspire-ctf-web/7-7.png></p><h2 id=words class=headerLink><a href=#words class=header-mark></a>Words</h2><h3 id=words1 class=headerLink><a href=#words1 class=header-mark></a>Words1</h3><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Our developer left something for you. Find it</div></div></div><p>Accessing the challenge site, we find a webpage.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/8-2.png data-srcset="/images/aspire-ctf-web/8-2.png, /images/aspire-ctf-web/8-2.png 1.5x, /images/aspire-ctf-web/8-2.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-2.png title=/images/aspire-ctf-web/8-2.png></p><p>Based on the hint, we can create a wordlist on extensions for common backup files, configuration files and archives.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bak
</span></span><span class=line><span class=cl>bk
</span></span><span class=line><span class=cl>config
</span></span><span class=line><span class=cl>cfg
</span></span><span class=line><span class=cl>tar
</span></span><span class=line><span class=cl>tar.gz
</span></span><span class=line><span class=cl>tar.xz
</span></span><span class=line><span class=cl>zip
</span></span></code></pre></div><p>We can then use raft-medium-words.txt wordlists from Seclists together with our extension lists to brute force for anything left by the developer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wfuzz -c --hc 404,403 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -w extensions.txt http://144.202.34.159/words/FUZZ.FUZ2Z 
</span></span></code></pre></div><p><img class=lazyload data-src=/images/aspire-ctf-web/wfuzz_word_one.png data-srcset="/images/aspire-ctf-web/wfuzz_word_one.png, /images/aspire-ctf-web/wfuzz_word_one.png 1.5x, /images/aspire-ctf-web/wfuzz_word_one.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/wfuzz_word_one.png title=/images/aspire-ctf-web/wfuzz_word_one.png></p><p>We get the flag by accessing: <a href=http://144.202.34.159/words/.env.bak target=_blank rel="noopener noreffer">http://144.202.34.159/words/.env.bak</a></p><p><img class=lazyload data-src=/images/aspire-ctf-web/word1_env_bak.png data-srcset="/images/aspire-ctf-web/word1_env_bak.png, /images/aspire-ctf-web/word1_env_bak.png 1.5x, /images/aspire-ctf-web/word1_env_bak.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/word1_env_bak.png title=/images/aspire-ctf-web/word1_env_bak.png></p><p>Nothing else could be found at the challenge site with popular wordlists. We can create a wordlist using words retrieved from the website using cewl. Cewl manages to generate a wordlist with 43 words.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cewl -w custom_wordlist.txt http://144.202.34.159/words/ 
</span></span></code></pre></div><p><img class=lazyload data-src=/images/aspire-ctf-web/8-3.png data-srcset="/images/aspire-ctf-web/8-3.png, /images/aspire-ctf-web/8-3.png 1.5x, /images/aspire-ctf-web/8-3.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-3.png title=/images/aspire-ctf-web/8-3.png></p><p>Using the custom wordlist, we discover two new paths.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wfuzz -c --hc <span class=m>404</span> -w custom_wordlist.txt http://144.202.34.159/words/FUZZ/ 
</span></span></code></pre></div><p><img class=lazyload data-src=/images/aspire-ctf-web/8-4.png data-srcset="/images/aspire-ctf-web/8-4.png, /images/aspire-ctf-web/8-4.png 1.5x, /images/aspire-ctf-web/8-4.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-4.png title=/images/aspire-ctf-web/8-4.png></p><p>Navigating to one of the discovered paths, computerphIles, we get this page.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/8-6.png data-srcset="/images/aspire-ctf-web/8-6.png, /images/aspire-ctf-web/8-6.png 1.5x, /images/aspire-ctf-web/8-6.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-6.png title=/images/aspire-ctf-web/8-6.png></p><p>We are told that vim was used to edit the page. Vim creates a swap file when editing a file in the form ‘.filename.swp’ for recovery purposes. This also prevents multiple instances of vim editing the same file. More information can be read here. Since our main file is index.html, the vim swap file would be ‘.index.html.swp’. Accessing this via the browser shows no content change but if we view the source code, we obtain the flag.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/8-7.png data-srcset="/images/aspire-ctf-web/8-7.png, /images/aspire-ctf-web/8-7.png 1.5x, /images/aspire-ctf-web/8-7.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-7.png title=/images/aspire-ctf-web/8-7.png></p><p>Accessing the other discovered path, we get this webpage.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/8-9.png data-srcset="/images/aspire-ctf-web/8-9.png, /images/aspire-ctf-web/8-9.png 1.5x, /images/aspire-ctf-web/8-9.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-9.png title=/images/aspire-ctf-web/8-9.png></p><p>Using our cewl wordlist together with seclists mosts common extensions, we get an archive, compartmentalize.tar.gz.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/8-10.png data-srcset="/images/aspire-ctf-web/8-10.png, /images/aspire-ctf-web/8-10.png 1.5x, /images/aspire-ctf-web/8-10.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-10.png title=/images/aspire-ctf-web/8-10.png></p><p>Downloading and extracting the archive, we get a flag.txt with our flag in it.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/8-11.png data-srcset="/images/aspire-ctf-web/8-11.png, /images/aspire-ctf-web/8-11.png 1.5x, /images/aspire-ctf-web/8-11.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/8-11.png title=/images/aspire-ctf-web/8-11.png></p><h2 id=executor class=headerLink><a href=#executor class=header-mark></a>Executor</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>A vulnerability exists. Find it and get the flag</div></div></div><p>We didn’t manage to solve this challenge within the ctf period. Accessing the challenge site yields a blank page with pre tags.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/9-1.png data-srcset="/images/aspire-ctf-web/9-1.png, /images/aspire-ctf-web/9-1.png 1.5x, /images/aspire-ctf-web/9-1.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/9-1.png title=/images/aspire-ctf-web/9-1.png></p><p>Using arjun, we discover ip parameter</p><p><img class=lazyload data-src=/images/aspire-ctf-web/9-2.png data-srcset="/images/aspire-ctf-web/9-2.png, /images/aspire-ctf-web/9-2.png 1.5x, /images/aspire-ctf-web/9-2.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/9-2.png title=/images/aspire-ctf-web/9-2.png></p><p>Specifying localhost as the payload, we get ping statistics for localhost. Sweet, we can now try and find command injection vulnerability</p><p><img class=lazyload data-src=/images/aspire-ctf-web/9-5.png data-srcset="/images/aspire-ctf-web/9-5.png, /images/aspire-ctf-web/9-5.png 1.5x, /images/aspire-ctf-web/9-5.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/9-5.png title=/images/aspire-ctf-web/9-5.png></p><p>Chaining the commands finally worked using pipe.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/9-6.png data-srcset="/images/aspire-ctf-web/9-6.png, /images/aspire-ctf-web/9-6.png 1.5x, /images/aspire-ctf-web/9-6.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/9-6.png title=/images/aspire-ctf-web/9-6.png></p><p>Displaying the txt file using cat but it didn’t work. Time to figure out why. Possibly there is a WAF filtering our requests.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/9-7.png data-srcset="/images/aspire-ctf-web/9-7.png, /images/aspire-ctf-web/9-7.png 1.5x, /images/aspire-ctf-web/9-7.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/9-7.png title=/images/aspire-ctf-web/9-7.png></p><p>Turns out the word cat is filtered out. This can be bypassed in different ways. One way could be using ‘cacatt’ so that even after filtering out, its still valid. What if ‘cat’ is recursively filtered out, this wouldn’t work. There are a couple of evasion techniques to try out from secjuice, payload all the things and many more.</p><p><img class=lazyload data-src=/images/aspire-ctf-web/9-8.png data-srcset="/images/aspire-ctf-web/9-8.png, /images/aspire-ctf-web/9-8.png 1.5x, /images/aspire-ctf-web/9-8.png 2x" data-sizes=auto alt=/images/aspire-ctf-web/9-8.png title=/images/aspire-ctf-web/9-8.png></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-04-06</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/aspire/>Aspire</a>,&nbsp;<a href=/tags/ctf/>CTF</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/forge-htb/ class=next rel=next title="Forge HackTheBox Writeup">Forge HackTheBox Writeup<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.96.0">Hugo</a>&nbsp;|&nbsp;Theme - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreffer" title="DoIt 0.2.13"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer"></a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/topbar/topbar.min.js></script><script type=text/javascript src=/lib/pjax/pjax.min.js></script><script type=text/javascript src=/js/theme.min.js></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:20},comment:{},data:{"desktop-header-typeit":"tukmogi","mobile-header-typeit":"tukmogi"},typeit:{cursorChar:null,cursorSpeed:null,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:null,speed:null}}</script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script></div></body></html>